import Modal from "./modal"
import Controller from './controller'
import Lang from '../utils/lang'
import Storage from '../utils/storage'
import Utils from '../utils/math'


function render(){
    let icon = `<svg width="31" height="31" viewBox="0 0 31 31" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M10.3284 2.65796C10.9444 2.42359 11.2538 1.73426 11.0195 1.11836C10.7851 0.502379 10.0959 0.192997 9.4799 0.427361C8.86391 0.661725 8.55453 1.35097 8.7889 1.96696C9.0231 2.58286 9.71243 2.89224 10.3284 2.65796ZM19.7477 27.4181C19.1317 27.6524 18.8223 28.3417 19.0566 28.9577C19.291 29.5736 19.9802 29.883 20.5962 29.6487C21.2122 29.4144 21.5216 28.725 21.2873 28.1091C21.053 27.4932 20.3637 27.1838 19.7477 27.4181ZM0.77644 8.63687C0.506595 9.23813 0.775168 9.94433 1.37643 10.2142C1.9777 10.484 2.68389 10.2154 2.95374 9.6141C3.22358 9.01284 2.95493 8.30664 2.35374 8.0368C1.75248 7.76703 1.04629 8.0356 0.77644 8.63687ZM29.2997 21.4391C29.5695 20.8378 29.3009 20.1316 28.6996 19.8618C28.0983 19.5919 27.3922 19.8606 27.1223 20.4618C26.8524 21.063 27.121 21.7692 27.7223 22.0391C28.3236 22.3089 29.0298 22.0403 29.2997 21.4391ZM28.9577 11.0193C29.5737 10.785 29.8831 10.0957 29.6487 9.47974C29.4144 8.86375 28.7251 8.55437 28.1091 8.78866C27.4932 9.02302 27.1838 9.71227 27.4181 10.3283C27.6524 10.9443 28.3418 11.2537 28.9577 11.0193ZM1.11836 19.0566C0.502379 19.291 0.192997 19.9802 0.427361 20.5962C0.661645 21.2122 1.35097 21.5216 1.96696 21.2872C2.58294 21.0528 2.89232 20.3636 2.65796 19.7476C2.42359 19.1316 1.73434 18.8223 1.11836 19.0566ZM20.4618 2.95374C21.0631 3.22358 21.7693 2.95493 22.0391 2.35374C22.309 1.75248 22.0403 1.04629 21.4391 0.776441C20.8378 0.506596 20.1317 0.775248 19.8618 1.37651C19.5919 1.9777 19.8606 2.68389 20.4618 2.95374ZM9.61418 27.1223C9.01292 26.8524 8.30672 27.1211 8.03688 27.7224C7.76703 28.3236 8.03568 29.0298 8.63695 29.2997C9.23821 29.5695 9.94441 29.3009 10.2143 28.6996C10.4841 28.0982 10.2154 27.3921 9.61418 27.1223ZM5.77605 7.46362C5.81312 7.46473 5.85019 7.46473 5.88695 7.46696L7.70912 7.57587L7.67085 5.98337L6.09204 4.40455C5.62609 3.93861 4.87049 3.93861 4.40447 4.40455C3.93845 4.87049 3.93853 5.62609 4.40447 6.09212L5.77605 7.46362ZM3.42604 13.8447H1.1933C0.53428 13.8447 0 14.3789 0 15.038C0 15.697 0.53428 16.2313 1.1933 16.2313H3.13146C3.15843 16.2058 3.1854 16.1804 3.21324 16.1558L4.57925 14.9439L3.42604 13.8447ZM25.6715 6.09212C26.1375 5.62617 26.1376 4.87057 25.6715 4.40455C25.2056 3.93845 24.45 3.93861 23.984 4.40455L22.6135 5.77502C22.6125 5.81193 22.6113 5.84892 22.6091 5.88599L22.5001 7.7092L24.0927 7.67093L25.6715 6.09212ZM15.1322 4.57925L16.2313 3.42597V1.1933C16.2313 0.53428 15.6971 0 15.038 0C14.379 0 13.8447 0.53428 13.8447 1.1933V3.13265C13.87 3.15946 13.8958 3.18571 13.9203 3.2134L15.1322 4.57925ZM4.40455 23.9839C3.93861 24.4498 3.93853 25.2054 4.40455 25.6715C4.63756 25.9046 4.94297 26.021 5.24829 26.021C5.55362 26.021 5.8591 25.9045 6.09204 25.6715L7.4625 24.301C7.46354 24.2641 7.46473 24.2271 7.46696 24.19L7.57587 22.3668L5.98329 22.4051L4.40455 23.9839ZM28.8827 13.8447H26.9446C26.9178 13.8701 26.8907 13.8954 26.8629 13.9201L25.4968 15.1321L26.6501 16.2313H28.8827C29.5417 16.2313 30.076 15.697 30.076 15.038C30.076 14.3789 29.5417 13.8447 28.8827 13.8447ZM24.2999 22.6123C24.2646 22.6113 24.2292 22.6113 24.194 22.6092L22.3668 22.5001L22.4051 24.0927L23.9839 25.6715C24.2169 25.9045 24.5223 26.021 24.8276 26.021C25.133 26.021 25.4385 25.9045 25.6714 25.6715C26.1374 25.2055 26.1373 24.4499 25.6714 23.9839L24.2999 22.6123ZM14.9439 25.4968L13.8447 26.65V28.8827C13.8447 29.5417 14.379 30.076 15.038 30.076C15.6971 30.076 16.2313 29.5417 16.2313 28.8827V26.9434C16.2061 26.9166 16.1803 26.8903 16.1558 26.8626L14.9439 25.4968Z" fill="currentColor"/>
    <path d="M20.0267 24.4582L19.9186 19.9629L24.3323 20.2266C24.8317 20.2555 25.2976 19.9708 25.4976 19.5116C25.5951 19.2874 25.6215 19.0386 25.573 18.7989C25.5246 18.5593 25.4037 18.3402 25.2267 18.1715L21.9716 15.0693L25.2789 12.1347C25.4618 11.9724 25.5904 11.7579 25.6474 11.5201C25.7043 11.2823 25.6868 11.0328 25.5973 10.8053C25.5078 10.5777 25.3505 10.3832 25.1468 10.248C24.9431 10.1128 24.7028 10.0434 24.4584 10.0492L19.963 10.1573L20.2267 5.74363C20.2412 5.49956 20.1804 5.25691 20.0525 5.04851C19.9247 4.84011 19.7358 4.67602 19.5116 4.57844C19.2875 4.48086 19.0387 4.45451 18.799 4.50294C18.5594 4.55137 18.3404 4.67224 18.1716 4.84922L15.0694 8.1043L12.1348 4.79703C11.9725 4.61415 11.758 4.48554 11.5202 4.4286C11.2824 4.37165 11.0329 4.38913 10.8054 4.47865C10.5778 4.56818 10.3833 4.72543 10.2481 4.92915C10.1129 5.13286 10.0435 5.37319 10.0493 5.61762L10.1574 10.1129L5.74374 9.84922C5.49967 9.83468 5.25701 9.89547 5.04861 10.0234C4.84022 10.1512 4.67613 10.34 4.57855 10.5642C4.48097 10.7884 4.45462 11.0372 4.50304 11.2769C4.55147 11.5165 4.67235 11.7355 4.84932 11.9042L8.10441 15.0066L4.79706 17.941C4.61414 18.1033 4.4855 18.3178 4.42854 18.5557C4.37159 18.7935 4.38906 19.043 4.4786 19.2706C4.66205 19.7367 5.11821 20.0393 5.61765 20.0266L10.113 19.9186L9.84933 24.3321C9.83479 24.5762 9.89558 24.8189 10.0235 25.0273C10.1513 25.2357 10.3402 25.3998 10.5644 25.4973C10.7885 25.5949 11.0373 25.6213 11.277 25.5728C11.5166 25.5244 11.7356 25.4035 11.9044 25.2266L15.0066 21.9715L17.9412 25.2788C18.1034 25.4618 18.318 25.5905 18.5558 25.6475C18.7936 25.7045 19.0432 25.687 19.2708 25.5975C19.4983 25.508 19.6929 25.3506 19.8281 25.1469C19.9633 24.9431 20.0326 24.7027 20.0267 24.4582Z" fill="currentColor"/>
    </svg>`

    let text = {
        ru: `Три года назад мы запустили приложение Lampa, чтобы подарить вам мир любимых фильмов, сериалов и мультфильмов в удобном формате. Благодаря вам, нашему сообществу, мы стали больше, лучше и интереснее! В честь нашего дня рождения мы подготовили особый подарок: скидки на подписку CUB Premium! Теперь у вас есть возможность насладиться всеми преимуществами премиум-функций по ещё более выгодной цене.
        <br><br>
        Акция действует 10 дней — с 20 сентября по 30 сентября! Не упустите шанс стать частью клуба CUB Premium и получить максимум от вашего приложения! Все подробности на нашем сайте <a href="https://cub.red/premium" target="_blank">cub.red/premium</a>
        <br><br>
        Спасибо, что выбираете Lampa и празднуете вместе с нами!`,
        uk: `Три роки тому ми запустили додаток Lampa, щоб подарувати вам світ улюблених фільмів, серіалів та мультфільмів у зручному форматі. Завдяки вам, нашій спільноті, ми стали більшими, кращими та цікавішими! На честь нашого дня народження ми підготували особливий подарунок: знижки на підписку CUB Premium! Тепер у вас є можливість насолодитися всіма перевагами преміум-функцій за ще більш вигідною ціною.
        <br><br>
        Акція діє 10 днів — з 20 вересня до 30 вересня! Не втратьте шанс стати частиною клубу CUB Premium та отримати максимум від вашого додатка! Усі деталі на нашому сайті <a href="https://cub.red/premium" target="_blank">cub.red/premium</a>.
        <br><br>
        Дякуємо, що обираєте Lampa і святкуєте разом з нами!`
    }

    let html = $(`
        <div class="birthday">
            <div class="birthday__poster">
                <img class="birthday__img" />
            </div>

            <div class="birthday__text">${text[Storage.get('language', 'ru')]}</div>
        </div>`)

    let btn = $('<div class="head__action selector icon--blink"></div>')

    btn.on('hover:enter',()=>{
        Modal.open({
            title: '',
            size: 'medium',
            html: html,
            mask: false,
            onBack: ()=>{
                Modal.close()

                Controller.toggle('head')
            }
        })

        Utils.imgLoad(html.find('img')[0],'https://cdn.cub.red/img/other/birthday_3_years.jpg',()=>{
            html.addClass('loaded')
        },()=>{
            html.addClass('noload')
        })
    })

    btn.append(icon)

    $('.head .head__actions .open--settings').after(btn)
}

function start(){
    let date_start = '2024-09-20T10:00:00'
    let date_end   = '2024-09-30T22:00:00'

    let time_start = new Date(date_start).getTime()
    let time_end   = new Date(date_end).getTime()
    let time_now   = new Date().getTime()

    if(time_now > time_start && time_now < time_end && Lang.selected(['ru','uk'])) render()
}

export default {
    start
}